<div class="row" ng-show="error">
	<div class="span12">
		<div class="alert alert-error">
			{{error}}
			<button type="button" class="close" ng-click="closeError()">&times;</button>
		</div>
	</div>
</div>

<div class="hero-unit" ng-hide="loggedIn">
	<h1>Join my Talk!</h1>
	<h2>Present. Everywhere.</h2>

	<p>Join my Talk! is a website to present everywhere you have an 
	HTML5-capable web browser available. Just upload your 
	presentation (currently supported: PDF, Microsoft PowerPoint, 
	OpenOffice/LibreOffice Impress). No setup, Flash or plugins 
	required!</p>

	<p>The audience can follow your talk, see exactly what you show 
	on the screen, and read any additional notes that you provide 
	with your slides. In the room you present, or remotely via the 
	internet.</p>

	<p>
		<a href="/auth/gplus" target="_self"><img src="/assets/img/gplus-signin-button.png" alt="Sign In with Google+" style="width: 182px; height: 40px"></a>
		<a href="/auth/twitter" target="_self"><img src="/assets/img/twitter-signin-button.png" alt="Sign In with Twitter" style="width: 158px; height: 28px"></a>
	</p>
</div>
<div ng-show="loggedIn">

	<!-- upload form -->
	<button class="btn btn-primary" ng-click="openUpload()" ng-hide="showUpload">
		<i class="icon-upload-alt"></i>
		Upload Presentation
	</button>
	<form ng-upload action="/api/upload" class="form-horizontal" ng-show="showUpload" id="upload_form">
		<legend>Upload Presentation</legend>
		<div class="control-group">
			<div class="control-label">File you want to upload</div>
			<div class="controls">
				<input type="file" name="file">
			</div>
		</div>
		<div class="control-group">
			<div class="control-label">Presentation title</div>
			<div class="controls">
				<input type="text" placeholder="The title of your presentation" name="title">
			</div>
		</div>
		<div class="control-group">
			<div class="controls">
				<button type="submit" class="btn btn-primary" upload-submit="uploadComplete(content, completed)">Save</button>
				<button type="button" class="btn" ng-click="hideUpload()">Cancel</button>
			</div>
		</div>
	</form>

	<!-- presentation list -->
	<h3>Your Presentations</h3>
	<table class="table" ng-show="uploads.length > 0">
		<tr><th>Title</th><th>Link</th><th>Actions</th></tr>
		<tr ng-repeat="upload in uploads">
			<td>
				<a ng-href="/v/{{upload.id}}" ng-show="!upload.renaming && upload.conversion == 'success'">{{upload.title}}</a>
				<span ng-show="upload.conversion != 'success'">{{upload.title}}</span>
				<span ng-show="upload.renaming">
					<input type="text" ng-model="upload.title">
					<button class="btn btn-primary" ng-click="saveUploadRename($index)">Save</button>
					<button class="btn" ng-click="cancelUploadRename($index)">Cancel</button>
				</span>
			</td>
			<td>
				<a ng-show="upload.conversion == 'success'" ng-href="/userdata/{{upload.id}}.pdf" target="_blank">
					<i class="icon-download-alt"></i>
					Download
				</a>
				<span ng-show="upload.conversion == 'progress'">
					<!-- TODO: some animation? -->
					Processing upload...
				</span>
				<span ng-show="upload.conversion == 'error'">
					<!-- TODO: maybe red and scary? -->
					Error
				</span>
			</td>
			<td class="text-right">
				<span ng-show="upload.conversion == 'progress'">
					We are currently processing and converting your upload.
					<button class="btn" ng-click="getUploads()">
						<i class="icon-refresh"></i>
						Reload
					</button>
				</span>
				<span ng-show="upload.conversion == 'error'">
					Unfortunately, we encountered an error while processing your upload. Please make sure to only upload supported file types (PDF, PowerPoint, OpenOffice/LibreOffice).
				</span>

				<button ng-show="upload.conversion == 'success'" class="btn" ng-click="renameUpload($index)">
					<i class="icon-edit"></i>
					Rename
				</button>
				<button ng-show="upload.conversion == 'success'" class="btn" ng-click="startSession(upload.id)">
					<i class="icon-play"></i>
					Start Session
				</button>
				<button ng-show="upload.conversion != 'progress'" class="btn" ng-click="deleteUpload(upload.id)">
					<i class="icon-trash"></i>
					Delete Presentation
				</button>
			</td>
		</tr>
	</table>
	<p ng-show="loading_uploads">Loading presentations...</p>
	<p ng-show="uploads.length == 0 && !loading_uploads">You have no presentations uploaded.</p>

	<!-- session list -->
	<h3>Your Sessions</h3>
	<table class="table" ng-show="sessions.length > 0">
		<tr><th>Title</th><th>Started</th><th>Ended</th><th>Actions</th></tr>
		<tr ng-repeat="session in sessions">
			<td><a ng-href="/s/{{session.id}}">{{session.title}}</a></td>
			<td><span title="{{session.started}}">{{session.started_relative}}</span></td>
			<td><span title="{{session.ended}}">{{session.ended_relative}}</span></td>
			<td class="text-right">
				<button class="btn" ng-click="stopSession(session.id)" ng-show="!session.ended">
					<i class="icon-stop"></i>
					Stop Session
				</button>
				<button class="btn" ng-click="deleteSession(session.id)" ng-show="session.ended">
					<i class="icon-trash"></i>
					Delete Session
				</button>
			</td>
		</tr>
	</table>
	<p ng-show="loading_sessions">Loading sessions...</p>
	<p ng-show="sessions.length == 0 && !loading_sessions">You have no active sessions.</p>
</div>
